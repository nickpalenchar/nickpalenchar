---
import { Image } from "astro:assets";
import { Icon } from "astro-icon/components";
import { navBarLinks, identity, socialLinks } from "../config";
import type { SEOInfo } from "../types/config";

interface Props {
    seo: SEOInfo;
}

const { seo } = Astro.props;
---

<script>
    const linkMenuButton = document.getElementById(
        "link-menu-button",
    ) as HTMLButtonElement;
    const linkMenu = document.getElementById("link-menu") as HTMLDivElement;
    const openIndicator = document.getElementById(
        "open-indicator",
    ) as HTMLSpanElement;

    linkMenuButton.addEventListener("click", () => {
        if (linkMenu.classList.contains("opacity-0")) {
            linkMenu.classList.remove("pointer-events-none");
            linkMenu.classList.remove("opacity-0");
            openIndicator.innerText = "-";
        } else {
            linkMenu.classList.add("pointer-events-none");
            linkMenu.classList.add("opacity-0");
            openIndicator.innerText = "+";
        }
    });

    document.addEventListener("click", (event) => {
        const isLinkMenuButtonClicked =
            event.target === linkMenuButton ||
            linkMenuButton.contains(event.target as Node);
        const isLinkMenuClicked =
            event.target === linkMenu ||
            linkMenu.contains(event.target as Node);

        if (!isLinkMenuButtonClicked && !isLinkMenuClicked) {
            linkMenu.classList.add("pointer-events-none");
            linkMenu.classList.add("opacity-0");
            openIndicator.innerText = "+";
        }
    });
</script>

<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width" />
        <link rel="icon" type="image/svg+xml" href="/favicon.png" />
        <meta name="generator" content={Astro.generator} />
        <title>{seo.title}</title>
        <meta name="description" content={seo.description} />
        <meta property="og:title" content={seo.title} />
        <meta property="og:description" content={seo.description} />
        <meta property="og:image" content={seo.image} />
    </head>
    <body>
        <header>
            <div
                class="px-6 py-6 max-w-3xl mx-auto flex items-center justify-between"
            >
                <a href="/">
                    <Image
                        src={identity.altLogo}
                        alt={"Logo"}
                        width={50}
                        height={50}
                        class="w-[70px] h-[70px] object-cover"
                    />
                </a>
                <nav class="ml-auto mr-6 sm:m-0">
                    <ul class="hidden sm:flex sm:items-center sm:gap-2">
                        {
                            navBarLinks.map((link) => (
                                <li>
                                    <a
                                        class="group px-4 py-2 rounded-lg hover:bg-gray-bg opacity-60 hover:opacity-100 transition-all"
                                        href={link.url}
                                        target={
                                            link.external ? "_blank" : "_self"
                                        }
                                    >
                                        {link.title}
                                    </a>
                                </li>
                            ))
                        }
                    </ul>
                    <div class="relative sm:hidden">
                        <button
                            id="link-menu-button"
                            class="relative font-medium opacity-60 p-4"
                            >Menu <span id="open-indicator">+</span></button
                        >
                        <div
                            id="link-menu"
                            class="absolute p-2 right-0 bg-gray-bg rounded-lg w-44 transition-opacity ease-in-out duration-300 opacity-0 z-40"
                        >
                            <ul>
                                {
                                    navBarLinks.map((link) => (
                                        <li>
                                            <a
                                                class="block pl-4 py-3"
                                                href={link.url}
                                                target={
                                                    link.external
                                                        ? "_blank"
                                                        : "_self"
                                                }
                                            >
                                                {link.title}
                                            </a>
                                        </li>
                                    ))
                                }
                            </ul>
                        </div>
                    </div>
                </nav>
                <div class="flex items-center gap-2">
                    {
                        socialLinks.map((link) => (
                            <a
                                href={link.url}
                                class="block p-2 opacity-60 hover:opacity-100 transition-opacity"
                                aria-label={link.title}
                                target={link.external ? "_blank" : "_self"}
                            >
                                <Icon name={link.icon} width={20} height={20} />
                            </a>
                        ))
                    }
                </div>
            </div>
        </header>
        <main class="mb-32">
            <slot />
        </main>
        <footer></footer>
    </body>
</html>

<style is:global>
    @import url("https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap");

    html {
        font-family: "Inter", sans-serif;
        background: #000000;
    }

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        -webkit-font-smoothing: antialiased;
        color: white;
    }

    code {
        font-family:
            Menlo,
            Monaco,
            Lucida Console,
            Liberation Mono,
            DejaVu Sans Mono,
            Bitstream Vera Sans Mono,
            Courier New,
            monospace;
    }

    .hover-underline {
        text-decoration: underline 1px rgba(0, 0, 0, 0);
        text-underline-offset: 5px;
        transition: text-decoration-color 300ms;
    }

    .post:hover .hover-underline {
        text-decoration-color: rgba(255, 255, 255, 1);
    }

    .prose table {
        border-collapse: collapse;
        max-width: 95%;
        margin-left: auto;
        margin-right: auto;
        margin-top: 3rem;
        margin-bottom: 3rem;
    }

    .prose table th,
    .prose table td {
        border-right: 1px solid rgba(255, 255, 255, 0.2);
        border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        padding: 0.5rem;
    }

    .prose table th:last-child,
    .prose table td:last-child {
        border-right: none;
    }

    .prose table tr:last-child td {
        border-bottom: none;
    }

    .prose h1,
    .prose h2,
    .prose h3,
    .prose h4,
    .prose h5,
    .prose h6 {
        margin-top: 2.5rem;
        margin-bottom: 1.25rem;
    }

    .prose h1:first-child,
    .prose h2:first-child,
    .prose h3:first-child {
        margin-top: 0;
    }

    .prose p {
        margin-top: 1.5rem;
        margin-bottom: 1.5rem;
    }

    .prose p:first-child {
        margin-top: 0;
    }

    .prose ul,
    .prose ol {
        margin-top: 1.5rem;
        margin-bottom: 1.5rem;
    }

    .prose li {
        margin-top: 0.75rem;
        margin-bottom: 0.75rem;
    }

    .prose h2 + p,
    .prose h3 + p {
        margin-top: 1rem;
    }

    .prose p + table {
        margin-top: 3rem;
    }

    .prose table + h2,
    .prose table + h3 {
        margin-top: 3rem;
    }
</style>
